{% extends "base.html" %}{% load static %}

{% block css %}
  <link rel="stylesheet" type="text/css" href="/static/css/dist/css_datepicker/bootstrap-datepicker.min.css">
  <link rel="stylesheet" type="text/css" href="/static/css/dist/css/bootstrap-select.min.css" />
  <link rel="stylesheet" type="text/css" href="/static/css/adicionar_cliente.css" />

{% endblock %}


{% block loggedin %}
  <li><a>Usuário: {{ request.user.username }}</a></li>
  <li><a href="/logout" style="text-decoration: underline;">Sair</a></li>
{% endblock %}

{% block content %}
  <div class="my_menu">
    <div id="adicionar_message"><h3>Pedidos</h3></div>
  </div>
  <div class="my_menu2">
    <a href="/escolher_cliente"><button style="margin: 5px 0 5px 0;" class="btn btn-danger btn-block">Criar pedido</button></a>
  </div>
  <form action="./" method="GET">
    <div class="my_menu2">
      <button type="submit" class="btn btn-primary" name="button" value="filter">Visualizar pedidos</button>
    </div>
    <div style="text-align: center;" class="my_menu2">
      <h4>Filtrar por:</h4>
    </div>
    <div class="my_menu2">
      <div class="long-field input-group">
        <p>Nome Completo:</p>
        <input type="text" class="field_sizing form-control" placeholder="Nome Completo" aria-describedby="basic-addon1" name="nome">
      </div>
    </div>
    <div class="my_menu2">
      <div class="input-group">
        <p>Telefone:</p>
        <input id="telefone" style="width:140px;" type="text" class="field_sizing form-control" placeholder="Telefone" aria-describedby="basic-addon1" name="telefone" onkeypress='return event.charCode >= 48 && event.charCode <= 57' onchange="brPhoneStyle(event)">
      </div>
      <div style="width:120px;">
        <p>Data:</p>
        <input id="date_field" class="field_sizing form-control datepicker" data-date-format="mm/dd/yyyy" placeholder="Data" data-date-autoclose=true data-date-today-highlight=true name="data_field">
      </div>
    </div>
    <div style="margin-top: 20px;" class="my_menu2">
      <p style="margin-bottom: 15px;">Status:</p>
      <div style="display: flex; justify-content: space-between;" class="input-group">
        <label class="radio-inline"><input type="radio" name="status" value="True">Entregue</label>
        <label class="radio-inline"><input type="radio" name="status" value="False">Não Entregue</label>
      </div>
    </div>
    <div class="my_menu2">
      <p>Pagamento:</p>
      <div style="display: flex; justify-content: space-between;" class="input-group">
        <label class="radio-inline"><input type="radio" name="pago" value="True">Pago</label>
        <label class="radio-inline"><input type="radio" name="pago" value="False">Não Pago</label>
      </div>
    </div>
  </form>
{#  {% if success == 4 %}#}
{#  <div>#}
{#    <form name="toDelete" method="POST" onsubmit="return false;">#}
{#      {% for i in filtered %}#}
{#          <div class="filtered">#}
{#            <div class="alert alert-info" role="alert">#}
{#              <div style="display: flex;">#}
{#                <div class="listing">#}
{#                  <p><strong>Produto:</strong></p>#}
{#                  <p>{{ i.produto.nome }}</p>#}
{#                </div>#}
{#                <div class="listing">#}
{#                  <p><strong>Quantidade:</strong></p>#}
{#                  <p>{{ i.quantidade }}</p>#}
{#                </div>#}
{#                <div class="listing">#}
{#                  <p><strong>Data:</strong></p>#}
{#                  <p>{{ i.data}}<button type="submit" class="delete_button glyphicon glyphicon-remove" aria-hidden="true" value={{ i.id }} onclick="removeItem(event)"></button></p>#}
{#                </div>#}
{#              </div>#}
{#            </div>#}
{#          </div>#}
{#      {% endfor %}#}
{#    </form>#}
{#  </div>#}
{#  {% endif %}#}
{#  {% if success == 3 %}#}
{#    <div class="my_menu2">#}
{#      <div class="alert alert-danger">Insira nome completo e cidade</div>#}
{#    </div>#}
{#  {% endif %}#}
{#  {% if success == 4 %}#}
{#    <div class="my_menu2">#}
{#      <div class="alert alert-danger">Cliente já cadastrado</div>#}
{#    </div>#}
{#  {% endif %}#}
{% endblock %}


{% block script %}
  <script src="/static/js/js/bootstrap-select.min.js"></script>
  <script src="/static/js/js_datepicker/bootstrap-datepicker.min.js"></script>
  <script>
    $('.datepicker').datepicker();
    // creates an object with the types as keys and products as values
    var product_list = {
      // takes keys and values from the
      {% for tipo, query in products.items %}
        "{{ tipo }}": [
          {% for produto in query %}
            '{{ produto.nome }}',
          {% endfor %}
        ],
      {% endfor %}
    };

    function brPhoneStyle(event){
      var input = document.getElementById("telefone").value.replace(/\D/g, "");
      console.log(input);
      if(input.length === 10){
        document.getElementById("telefone").value = "(" + input.slice(0,2) + ")" + input.slice(2,6) + "-" + input.slice(-4);
      }
      else if(input.length === 11){
        document.getElementById("telefone").value = "(" + input.slice(0,2) + ")" + input.slice(2,7) + "-" + input.slice(-4);
      }else{
        document.getElementById("telefone").value = "";
      }
    }

    function removeItem() {
      $(document).ready(function (){
        var toDelete = document.activeElement.parentNode.parentNode.parentNode.parentNode.parentNode;
          $(toDelete).remove();
{#              axios.post('/remove/item/?id=123')#}
{#                  .then(function (response) {#}
{#                     console.log(response.data);#}
{#                  });#}
        });
    }




  </script>
{% endblock %}
